#textdomain wesnoth-NX-RPG

# Used to print melee specials
#define SPECIALS_M INDEX
    [option]
	# wmlindent: start ignoring
        message={MENU_IMG_TXT ($select_icon_{INDEX}) ( _ "<span color='#e1e119' weight='bold'>$select_text_{INDEX}| </span>")}
	# wmlindent: stop ignoring
        [show_if]
            {SXCON weapon_j greater_than {INDEX}}
            {SXCON range_{INDEX} equals melee}
        [/show_if]
        [command]
            [message]
                speaker=narrator
                image=$select_icon_{INDEX}
                # wmllint: display on
                message= _ "<span color='#e1e119' weight='bold'>Gold: $gold| </span>
<span color='#00e100' size='smaller'>Note: Specials that can be ADDED can ONLY be applied
as a 2ND Special. ELSE they are treated as NORMAL. Applying
a NORMAL Special will DELETE the PREVIOUS. You can add as
many ADDABLE Specials as you want to a Weapon.</span>
<span color='#14c8fa' size='smaller'>Note: BERSERK and RAGE are ONLY ACTIVE ON OFFENSE, but can be used in Defense</span>"
                # wmllint: display off

                [option]
	            # wmlindent: start ignoring
                    message={MENU_IMG_TXT (misc/check.png) ( _ "<span color='#14c8fa' weight='bold'>Done</span>")}
	            # wmlindent: stop ignoring
                    [command]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/charges.png) ( _ "<span color='#e1e119' weight='bold'>175: Melee $name_{INDEX}| weapon receive Charge</span>
<span size='smaller'>Charge: This attack deals double damage to the target on
offense, the attacker will also take double damage</span>
<span color='#00fa00' size='smaller'><small>can be ADDED to other specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {NOT_CLASS_GROUP_CASTERS}
                    [/show_if]
                    [command]
                        {IF_VAR gold greater_than_equal_to 175 (
                            [then]
                                [gold]
                                    side=1
                                    amount=-175
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 87}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            mode=append
                                            {WEAPON_SPECIAL_CHARGE}
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        )}
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/magicals.png) ( _ "<span color='#e1e119' weight='bold'>210: Melee $name_{INDEX}| weapon receive Magical</span>
<span size='smaller'>Magical: This attack always has a 70% chance to hit</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {NOT_CLASS_GROUP_CASTERS}
                    [/show_if]

                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=210
                            [/variable]
                            [then]
                                [gold]
                                    amount=-210
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 105}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            {WEAPON_SPECIAL_MAGICAL}
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/rages.png) ( _ "<span color='#e1e119' weight='bold'>250: Melee $name_{INDEX}| weapon receive Rage</span>
<span size='smaller'>Rage: This attack presses the engagement for 3 rounds</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {NOT_CLASS_GROUP_CASTERS}
                        {SXCON shop[$side_number|].devel.class not_equals cleric}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=250
                            [/variable]
                            [then]
                                [gold]
                                    amount=-250
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 125}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            [berserk]
                                                id=berserk
                                                name= _ "rage"
                                                description= _ "Rage:
When used offensively, this attack presses the engagement until one of the combatants is slain, or 3 rounds of attacks have occurred."
                                                value=3
                                                active_on=offense
                                            [/berserk]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/rages.png) ( _ "<span color='#e1e119' weight='bold'>210: Melee $name_{INDEX}| weapon receive Rage</span>
<span size='smaller'>Rage: This attack presses the engagement for 3 rounds</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {NOT_CLASS_GROUP_CASTERS}
                        {SXCON shop[$side_number].devel.clas equals cleric}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=210
                            [/variable]
                            [then]
                                [gold]
                                    amount=-210
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 105}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            [berserk]
                                                id=berserk
                                                name= _ "rage"
                                                description= _ "Rage:
When used offensively, this attack presses the engagement until one of the combatants is slain, or 3 rounds of attacks have occurred."
                                                value=3
                                                active_on=offense
                                            [/berserk]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/slows.png) ( _ "<span color='#e1e119' weight='bold'>275: Melee $name_{INDEX}| weapon receive Slow</span>
<span size='smaller'>Slow: Slow halves the damage caused by attacks and halves
movement</span>
<span color='#00fa00' size='smaller'><small>can be ADDED to other specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number|].abilities.stunning greater_than 0}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=275
                            [/variable]
                            [then]
                                [gold]
                                    amount=-275
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 137}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            mode=append
                                            {WEAPON_SPECIAL_SLOW}
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/slows.png) ( _ "<span color='#e1e119' weight='bold'>275: Melee $name_{INDEX}| weapon receive Slow</span>
<span size='smaller'>Slow: Slow halves the damage caused by attacks and halves
movement</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number|].abilities.stunning less_than 1}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=275
                            [/variable]
                            [then]
                                [gold]
                                    amount=-275
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 137}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            {WEAPON_SPECIAL_SLOW}
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/berserks.png) ( _ "<span color='#e1e119' weight='bold'>425: Melee $name_{INDEX}| weapon receive Berserk</span>
<span size='smaller'>Berserk: This attack presses the engagement for 30 rounds
Berserk is active on offense</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {NOT_CLASS_GROUP_CASTERS}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=425
                            [/variable]
                            [then]
                                [gold]
                                    amount=-425
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 212}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            [berserk]
                                                id=berserkss
                                                name= _ "berserk"
                                                description= _ "Berserk:
Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 30 rounds of attacks have occurred."
                                                value=30
                                                active_on=offense
                                            [/berserk]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/rageslows.png) ( _ "<span color='#e1e119' weight='bold'>525: Melee $name_{INDEX}| weapon receive Raged Slow</span>
<span size='smaller'>Raged Slow: halves the damage caused by attacks and
halves movement while pressing the engagement
for 3 rounds</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number|].abilities.stunning less_than 1}
                        {SXCON shop[$side_number|].devel.class not_equals cleric}
                        {NOT_CLASS_GROUP_CASTERS}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=525
                            [/variable]
                            [then]
                                [gold]
                                    amount=-525
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 262}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            {WEAPON_SPECIAL_SLOW}
                                            [berserk]
                                                id=berserk
                                                name= _ "rage"
                                                description= _ "Rage:
When used offensively, this attack presses the engagement until one of the combatants is slain, or 3 rounds of attacks have occurred."
                                                value=3
                                                active_on=offense
                                            [/berserk]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/rageslows.png) ( _ "<span color='#e1e119' weight='bold'>525: Melee $name_{INDEX}| weapon receive Raged Slow</span>
<span size='smaller'>Raged Slow: halves the damage caused by attacks and
halves movement while pressing the engagement
for 3 rounds</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number|].devel.class equals cleric}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=525
                            [/variable]
                            [then]
                                [gold]
                                    amount=-525
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 262}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            {WEAPON_SPECIAL_SLOW}
                                            [berserk]
                                                id=berserk
                                                name= _ "rage"
                                                description= _ "Rage:
When used offensively, this attack presses the engagement until one of the combatants is slain, or 3 rounds of attacks have occurred."
                                                value=3
                                                active_on=offense
                                            [/berserk]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/rageslows.png) ( _ "<span color='#e1e119' weight='bold'>525: Melee $name_{INDEX}| weapon receive Raged Slow</span>
<span size='smaller'>Raged Slow: halves the damage caused by attacks and
halves movement while pressing the engagement
for 3 rounds</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number|].abilities.stunning greater_than 0}
                        {NOT_CLASS_GROUP_CASTERS}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=525
                            [/variable]
                            [then]
                                [gold]
                                    amount=-525
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 262}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            {WEAPON_SPECIAL_SLOW}
                                            [berserk]
                                                id=berserk
                                                name= _ "rage"
                                                description= _ "Rage:
When used offensively, this attack presses the engagement until one of the combatants is slain, or 3 rounds of attacks have occurred."
                                                value=3
                                                active_on=offense
                                            [/berserk]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]
            [/message]
            [redraw]
            [/redraw]
        [/command]
    [/option]
#enddef

# Used to print ranged options
#define SPECIALS_R INDEX
    [option]
	# wmlindent: start ignoring
        message={MENU_IMG_TXT ($select_icon_{INDEX}) ( _ "<span color='#e1e119' weight='bold'>$select_text_{INDEX}| </span>")}
	# wmlindent: stop ignoring
        [show_if]
            {SXCON weapon_j greater_than {INDEX}}
            {SXCON range_{INDEX} equals ranged}
            {SXCON shop[$side_number].devel.class not_equals warrior}
        [/show_if]
        [command]
            [message]
                speaker=narrator
                image=$select_icon_{INDEX}
                # wmllint: display on
                message= _ "<span color='#e1e119' weight='bold'>Gold: $gold| </span>
<span color='#00e100' size='smaller'>Note: Specials that can be ADDED can ONLY be applied
as a 2ND Special. ELSE they are treated as NORMAL. Applying
a NORMAL Special will DELETE the PREVIOUS. You can add as
many ADDABLE Specials as you want to a Weapon.</span>"
                # wmllint: display off

                [option]
                    message={MENU_IMG_TXT (misc/check.png) ( _ "<span color='#14c8fa' weight='bold'>Done</span>")}
	 	    [command]
        	    [/command]
       		[/option]

		[option]
		    # wmllint: display on
             	    message={MENU_IMG_TXT (misc/thorns.png) ( _ "<span color='#e1e119' weight='bold'>100: Ranged $name_{INDEX}| weapon receive Blessing</span>
                    <span size='smaller'>Blessing: Blessed weapons do 10% more damage in battle on offense</span>
                    <span color='#00fa00' size='smaller'><small>can be ADDED to other specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number].devel.class not_equals warrior}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=100
                            [/variable]
                            [then]
                                [gold]
                                    side=1
                                    amount=-100
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 50}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            mode=append
                                            [damage]
                                                id=blessing
                                                name= _ "blessed"
                                                description= _ "Blessed:
When used offensively, blessed weapons do 10% more damage than usual. This weapon special isn't activated on defense."
                                                multiply=1.1
                                                apply_to=self
                                                active_on=offense
                                            [/damage]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/dextrouss.png) ( _ "<span color='#e1e119' weight='bold'>150: Ranged $name_{INDEX}| weapon receive Marksman</span>
<span size='smaller'>Marksman: This attack has at least a 60% chance to hit on offense</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number].abilities.precision less_than 1}
                        {SXCON shop[$side_number].devel.class not_equals warrior}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=150
                            [/variable]
                            [then]
                                [gold]
                                    side=1
                                    amount=-150
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 75}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            {WEAPON_SPECIAL_MARKSMAN}
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/marksmans.png) ( _ "<span color='#e1e119' weight='bold'>125: Ranged $name_{INDEX}| weapon receive Precision</span>
<span size='smaller'>Precision: This attack always has a 80% chance to hit when used offensively</span>
<span color='#00fa00' size='smaller'><small>can be ADDED to other specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number].abilities.precision greater_than 0}
                        {SXCON shop[$side_number].devel.class not_equals warrior}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=125
                            [/variable]
                            [then]
                                [gold]
                                    side=1
                                    amount=-125
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 62}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            mode=append
                                            [chance_to_hit]
                                                id=precisionss
                                                name= _ "precision"
                                                description= _ "Precision:
This attack always has a 80% chance to hit regardless of the defensive ability of the unit being attacked."
                                                value=80
                                                cumulative=no
                                                active_on=offense
                                            [/chance_to_hit]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/magicalss.png) ( _ "<span color='#e1e119' weight='bold'>210: Ranged $name_{INDEX}| weapon receive Magical</span>
<span size='smaller'>Magical: This attack always has a 70% chance to hit</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number].devel.class not_equals warrior}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=210
                            [/variable]
                            [then]
                                [gold]
                                    side=1
                                    amount=-210
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 105}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            {WEAPON_SPECIAL_MAGICAL}
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/slowss.png) ( _ "<span color='#e1e119' weight='bold'>300: Ranged $name_{INDEX}| weapon receive Slow</span>
<span size='smaller'>Slow: Slow halves the damage caused by attacks and halves
movement</span>
<span color='#00fa00' size='smaller'><small>can be ADDED to other specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number].devel.class not_equals warrior}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=300
                            [/variable]
                            [then]
                                [gold]
                                    side=1
                                    amount=-300
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 150}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            mode=append
                                            {WEAPON_SPECIAL_SLOW}
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/focuss.png) ( _ "<span color='#e1e119' weight='bold'>300: Ranged $name_{INDEX}| weapon receive Focus</span>
<span size='smaller'>Focus: Offensively, this attack always has a 70% chance to hit
both the attacker and the defender do 50% more damage</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number].devel.class not_equals warrior}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=300
                            [/variable]
                            [then]
                                [gold]
                                    side=1
                                    amount=-300
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 150}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            [damage]
                                                id=focus
                                                name= _ "focus"
                                                description= _ "Focus:
When used offensively, this attack always has a 70% chance to hit and causes both the attacker and the defender to do 50% more damage than usual. This weapon special isn't activated on defense."
                                                multiply=1.5
                                                apply_to=both
                                                active_on=offense
                                            [/damage]
                                            [chance_to_hit]
                                                id=focus
                                                value=70
                                                cumulative=no
                                                active_on=offense
                                            [/chance_to_hit]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/precisions.png) ( _ "<span color='#e1e119' weight='bold'>425: Ranged $name_{INDEX}| weapon receive Precision Focus</span>
<span size='smaller'>Precision Focus: On Offense, this attack has a 80% chance
to hit, the attacker and the defender do 50% more damage</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number].abilities.precision less_than 1}
                        {SXCON shop[$side_number].devel.class not_equals warrior}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=425
                            [/variable]
                            [then]
                                [gold]
                                    amount=-425
                                    side=1
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 212}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            [damage]
                                                id=Precision Focus
                                                name= _ "Precision Focus"
                                                description= _ "Precision Focus:
When used offensively, this attack always has a 80% chance to hit and causes both the attacker and the defender to do 50% more damage than usual. This weapon special isn't activated on defense."
                                                multiply=1.5
                                                apply_to=both
                                                active_on=offense
                                            [/damage]
                                            [chance_to_hit]
                                                id=Precision Focus
                                                value=80
                                                cumulative=no
                                                active_on=offense
                                            [/chance_to_hit]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]

                [option]
                    # wmllint: display on
                    message={MENU_IMG_TXT (misc/precisions.png) ( _ "<span color='#e1e119' weight='bold'>400: Ranged $name_{INDEX}| weapon receive Precision Focus</span>
<span size='smaller'>Precision Focus: On Offense, this attack has a 80% chance
to hit, the attacker and the defender do 50% more damage</span>
<span color='#14c8fa' size='smaller'><small>will overwrite current Specials</small></span>")}
                    # wmllint: display off
                    [show_if]
                        {SXCON shop[$side_number].abilities.precision greater_than 0}
                        {SXCON shop[$side_number].devel.class not_equals warrior}
                    [/show_if]
                    [command]
                        [if]
                            [variable]
                                name=gold
                                greater_than_equal_to=400
                            [/variable]
                            [then]
                                [gold]
                                    side=1
                                    amount=-400
                                [/gold]
                                {VARIABLE_OP shop[$side_number].enhance.hitpoints_bought add 200}
                                [object]
                                    silent=yes
                                    [effect]
                                        apply_to=attack
                                        name=$name_{INDEX}
                                        type=$type_{INDEX}
                                        range=$range_{INDEX}
                                        [set_specials]
                                            #mode=append
                                            [damage]
                                                id=Precision Focus
                                                name= _ "Precision Focus"
                                                description= _ "Precision Focus:
When used offensively, this attack always has a 80% chance to hit and causes both the attacker and the defender to do 50% more damage than usual. This weapon special isn't activated on defense."
                                                multiply=1.5
                                                apply_to=both
                                                active_on=offense
                                            [/damage]
                                            [chance_to_hit]
                                                id=Precision Focus
                                                value=80
                                                cumulative=no
                                                active_on=offense
                                            [/chance_to_hit]
                                        [/set_specials]
                                    [/effect]
                                [/object]
                                [fire_event]
                                    name=unluckify_unit
                                    [primary_unit]
                                        x=$unit.x
                                        y=$unit.y
                                    [/primary_unit]
                                [/fire_event]
                            [/then]
                        [/if]
                    [/command]
                [/option]
            [/message]
            [redraw][/redraw]
        [/command]
    [/option]
#enddef

#define CATEGORY_SPECIALS
    [option]
        # wmllint: display on
        message={MENU_IMG_TXT (attacks/frenzy.png) ( _ "<span color='#e1e119' weight='bold'>Weaponsmith</span>
<span size='smaller'>Upgrade weapons with powerful specials</span>")}
        # wmllint: display off
        [command]
            {VARIABLE finished_sub no}
            [while]
                {SXCON finished_sub equals no}
                [do]
                    [store_gold]
                        side=1
                        variable=gold
                    [/store_gold]
                    [store_unit]
                        [filter]
                            side=1
                            x,y=$x1,$y1
                            canrecruit=yes
                        [/filter]
                        variable=weapons
                    [/store_unit]

                    {VARIABLE weapon_j 0}

                    {FOREACH weapons.attack weapon_i}
                        {VARIABLE select_icon_$weapon_j "attacks/blank-attack.png"}
                        {VARIABLE name_$weapon_j $weapons.attack[$weapon_i].name}
                        {VARIABLE type_$weapon_j $weapons.attack[$weapon_i].type}
                        {VARIABLE range_$weapon_j $weapons.attack[$weapon_i].range}
                        {VARIABLE damage $weapons.attack[$weapon_i|].damage}
                        {VARIABLE number $weapons.attack[$weapon_i|].number}
                        {VARIABLE select_icon_$weapon_j $weapons.attack[$weapon_i|].icon}

                        {IF_VAR select_icon_$weapon_j equals "attacks/blank-attack.png" (
                            [then]
                                {VARIABLE weapons.attack[$weapon_i|].icon "attacks/$weapons.attack[$weapon_i].name|.png"}
                                {VARIABLE select_icon_$weapon_j $weapons.attack[$weapon_i|].icon}
                            [/then]
                        )}

                        {VARIABLE select_text_$weapon_j "$name_$weapon_j|: $range_$weapon_j| $type_$weapon_j| $damage| - $number|"}
                        {VARIABLE_OP weapon_j add 1}
                        {CLEAR_VARIABLE damage}
                        {CLEAR_VARIABLE number}
                    {NEXT weapon_i}

                    [message]
                        speaker=narrator
                        image=wesnoth-icon.png
                        # wmllint: display on
                        message= _ "<span color='#e1e119' weight='bold'>Gold: $gold| </span>
<span color='#ffffff' size='smaller'>Here you can add/exchange specials for any
weapon you have, but every weapon can only hold only ONE
special at a time. An exception are ADDABLE specials, which can be APPLIED.
You CAN'T apply a non-addable special to a weapon without losing the current one, 
even if the current special is addable. So be CAREFUL.</span>
<span color='#14c8fa'>Select the weapon to which you want to add/exchange a special:</span>"
                        # wmllint: display off
                        [option]
			    # wmlindent: start ignoring
                            message={MENU_IMG_TXT ("misc/check.png") ( _ "<span color='#14c8fa' weight='bold'>Melee (Done)</span>")}
			    # wmlindent: stop ignoring
                            [command]
                                {VARIABLE finished_sub yes}
                            [/command]
                        [/option]

                        {SPECIALS_M 0}
                        {SPECIALS_M 1}
                        {SPECIALS_M 2}
                        {SPECIALS_M 3}
                        {SPECIALS_M 4}
                        {SPECIALS_M 5}
                        {SPECIALS_M 6}

                        [option]
			    # wmlindent: start ignoring
                            message={MENU_IMG_TXT (misc/check.png) ( _ "<span color='#14c8fa' weight='bold'>Ranged (Done)</span>")}
			    # wmlindent: stop ignoring
                            [show_if]
                                {SXCON shop[$side_number].devel.class not_equals warrior}
                            [/show_if]
                            [command]
                                {VARIABLE finished_sub yes}
                            [/command]
                        [/option]

                        {SPECIALS_R 0}
                        {SPECIALS_R 1}
                        {SPECIALS_R 2}
                        {SPECIALS_R 3}
                        {SPECIALS_R 4}
                        {SPECIALS_R 5}
                        {SPECIALS_R 6}

                        [option]
			    # wmlindent: start ignoring
                            message={MENU_IMG_TXT (misc/check.png) ( _ "<span color='#14c8fa' weight='bold'>Done</span>")}
			    # wmlindent: stop ignoring
                            [command]
                                {VARIABLE finished_sub yes}
                            [/command]
                        [/option]
                    [/message]
                    {VARIABLE weapon_i 0}
                    [while]
                        {SXCON weapon_i less_than $weapon_j}
                        [do]
                            {CLEAR_VARIABLE select_icon_$weapon_i}
                            {CLEAR_VARIABLE select_text_$weapon_i}
                            {CLEAR_VARIABLE type_$weapon_i}
                            {CLEAR_VARIABLE range_$weapon_i}
                            {CLEAR_VARIABLE name_$weapon_i}
                            {VARIABLE_OP weapon_i add 1}
                        [/do]
                    [/while]
                    {CLEAR_VARIABLE weapon_i}
                    {CLEAR_VARIABLE weapon_j}
                    {CLEAR_VARIABLE weapons}
                    [redraw][/redraw]
                [/do]
            [/while]
        [/command]
    [/option]
#enddef
